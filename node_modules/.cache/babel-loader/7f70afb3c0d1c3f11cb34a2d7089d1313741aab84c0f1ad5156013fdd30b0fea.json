{"ast":null,"code":"import React,{useEffect,useState}from'react';import axios from'axios';import{useParams}from'react-router-dom';import L from'leaflet';import'./WeatherDetails.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";let mapInstance=null;// Globalna zmienna do przechowywania instancji mapy\nconst WeatherDetailsPage=()=>{const{city}=useParams();const[weather,setWeather]=useState(null);const[forecast,setForecast]=useState(null);// Stan na dane prognozy\nconst[error,setError]=useState(null);const[temperatureUnit]=useState(()=>{return localStorage.getItem('temperatureUnit')||'metric';});useEffect(()=>{const fetchWeather=async()=>{try{// Pobierz aktualną pogodę\nconst weatherResponse=await axios.get(\"https://api.openweathermap.org/data/2.5/weather\",{params:{q:\"\".concat(city,\",PL\"),appid:process.env.REACT_APP_WEATHER_API_KEY,units:temperatureUnit,lang:\"pl\"}});setWeather(weatherResponse.data);// Pobierz prognozę pogody\nconst forecastResponse=await axios.get(\"https://api.openweathermap.org/data/2.5/forecast\",{params:{q:\"\".concat(city,\",PL\"),appid:process.env.REACT_APP_WEATHER_API_KEY,units:temperatureUnit,lang:\"pl\"}});setForecast(forecastResponse.data);}catch(error){setError(\"Błąd pobierania danych pogodowych.\");}};fetchWeather();},[city,temperatureUnit]);useEffect(()=>{if(weather){// Sprawdź, czy mapa już istnieje\nif(mapInstance){mapInstance.remove();// Usuń istniejącą mapę, aby uniknąć błędu\n}// Inicjalizacja mapy\nmapInstance=L.map('map').setView([weather.coord.lat,weather.coord.lon],10);// Dodanie warstwy OpenStreetMap\nL.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',{maxZoom:19}).addTo(mapInstance);// Dodanie warstwy radaru pogodowego z OpenWeatherMap\nL.tileLayer(\"https://tile.openweathermap.org/map/precipitation_new/{z}/{x}/{y}.png?appid=\".concat(process.env.REACT_APP_WEATHER_API_KEY),{maxZoom:19,opacity:0.5}).addTo(mapInstance);}},[weather]);if(error){return/*#__PURE__*/_jsx(\"p\",{className:\"error-message\",children:error});}if(!weather||!forecast){return/*#__PURE__*/_jsx(\"p\",{className:\"loading-message\",children:\"\\u0141adowanie danych...\"});}return/*#__PURE__*/_jsxs(\"div\",{className:\"container\",children:[/*#__PURE__*/_jsxs(\"h1\",{children:[\"Pogoda w \",weather.name]}),/*#__PURE__*/_jsx(\"div\",{className:\"weather-section\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"weather-info\",children:[/*#__PURE__*/_jsx(\"img\",{src:\"https://openweathermap.org/img/wn/\".concat(weather.weather[0].icon,\"@2x.png\"),alt:weather.weather[0].description}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Temperatura:\"}),\" \",weather.main.temp,temperatureUnit==='metric'?'°C':'°F']}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Warunki:\"}),\" \",weather.weather[0].description]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Wiatr:\"}),\" \",weather.wind.speed,\" \",temperatureUnit==='metric'?'m/s':'mph',\" (\",weather.wind.deg,\"\\xB0)\"]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Zachmurzenie:\"}),\" \",weather.clouds.all,\"%\"]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Opady:\"}),\" \",weather.rain?weather.rain[\"3h\"]:0,\" mm deszczu\"]})]})]})}),/*#__PURE__*/_jsx(\"div\",{id:\"map\",style:{width:'400px',height:'400px',margin:'20px auto'}}),/*#__PURE__*/_jsx(\"h2\",{children:\"Prognoza pogody\"}),/*#__PURE__*/_jsxs(\"table\",{className:\"forecast-table\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"Data i godzina\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Temperatura\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Warunki\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Wiatr\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:forecast.list.map(item=>/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:new Date(item.dt*1000).toLocaleString('pl-PL')}),/*#__PURE__*/_jsxs(\"td\",{children:[item.main.temp,\" \",temperatureUnit==='metric'?'°C':'°F']}),/*#__PURE__*/_jsxs(\"td\",{children:[/*#__PURE__*/_jsx(\"img\",{src:\"https://openweathermap.org/img/wn/\".concat(item.weather[0].icon,\".png\"),alt:item.weather[0].description}),item.weather[0].description]}),/*#__PURE__*/_jsxs(\"td\",{children:[item.wind.speed,\" \",temperatureUnit==='metric'?'m/s':'mph']})]},item.dt))})]})]});};export default WeatherDetailsPage;","map":{"version":3,"names":["React","useEffect","useState","axios","useParams","L","jsx","_jsx","jsxs","_jsxs","mapInstance","WeatherDetailsPage","city","weather","setWeather","forecast","setForecast","error","setError","temperatureUnit","localStorage","getItem","fetchWeather","weatherResponse","get","params","q","concat","appid","process","env","REACT_APP_WEATHER_API_KEY","units","lang","data","forecastResponse","remove","map","setView","coord","lat","lon","tileLayer","maxZoom","addTo","opacity","className","children","name","src","icon","alt","description","main","temp","wind","speed","deg","clouds","all","rain","id","style","width","height","margin","list","item","Date","dt","toLocaleString"],"sources":["C:/Users/pacan/Documents/Studia/Nowatorski projekt zespołowy/Aplikacja-Pogodowa/src/components/WeatherDetails.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport axios from 'axios';\r\nimport { useParams } from 'react-router-dom';\r\nimport L from 'leaflet';\r\nimport './WeatherDetails.css';\r\n\r\nlet mapInstance = null; // Globalna zmienna do przechowywania instancji mapy\r\n\r\nconst WeatherDetailsPage = () => {\r\n  const { city } = useParams();\r\n  const [weather, setWeather] = useState(null);\r\n  const [forecast, setForecast] = useState(null); // Stan na dane prognozy\r\n  const [error, setError] = useState(null);\r\n  const [temperatureUnit] = useState(() => {\r\n    return localStorage.getItem('temperatureUnit') || 'metric';\r\n  });\r\n\r\n  useEffect(() => {\r\n    const fetchWeather = async () => {\r\n      try {\r\n        // Pobierz aktualną pogodę\r\n        const weatherResponse = await axios.get(\"https://api.openweathermap.org/data/2.5/weather\", {\r\n          params: {\r\n            q: `${city},PL`,\r\n            appid: process.env.REACT_APP_WEATHER_API_KEY,\r\n            units: temperatureUnit,\r\n            lang: \"pl\",\r\n          },\r\n        });\r\n        setWeather(weatherResponse.data);\r\n\r\n        // Pobierz prognozę pogody\r\n        const forecastResponse = await axios.get(\"https://api.openweathermap.org/data/2.5/forecast\", {\r\n          params: {\r\n            q: `${city},PL`,\r\n            appid: process.env.REACT_APP_WEATHER_API_KEY,\r\n            units: temperatureUnit,\r\n            lang: \"pl\",\r\n          },\r\n        });\r\n        setForecast(forecastResponse.data);\r\n      } catch (error) {\r\n        setError(\"Błąd pobierania danych pogodowych.\");\r\n      }\r\n    };\r\n\r\n    fetchWeather();\r\n  }, [city, temperatureUnit]);\r\n\r\n  useEffect(() => {\r\n    if (weather) {\r\n      // Sprawdź, czy mapa już istnieje\r\n      if (mapInstance) {\r\n        mapInstance.remove(); // Usuń istniejącą mapę, aby uniknąć błędu\r\n      }\r\n\r\n      // Inicjalizacja mapy\r\n      mapInstance = L.map('map').setView([weather.coord.lat, weather.coord.lon], 10);\r\n\r\n      // Dodanie warstwy OpenStreetMap\r\n      L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {\r\n        maxZoom: 19,\r\n      }).addTo(mapInstance);\r\n\r\n      // Dodanie warstwy radaru pogodowego z OpenWeatherMap\r\n      L.tileLayer(`https://tile.openweathermap.org/map/precipitation_new/{z}/{x}/{y}.png?appid=${process.env.REACT_APP_WEATHER_API_KEY}`, {\r\n        maxZoom: 19,\r\n        opacity: 0.5,\r\n      }).addTo(mapInstance);\r\n    }\r\n  }, [weather]);\r\n\r\n  if (error) {\r\n    return <p className=\"error-message\">{error}</p>;\r\n  }\r\n\r\n  if (!weather || !forecast) {\r\n    return <p className=\"loading-message\">Ładowanie danych...</p>;\r\n  }\r\n\r\n  return (\r\n    <div className=\"container\">\r\n      <h1>Pogoda w {weather.name}</h1>\r\n      <div className=\"weather-section\">\r\n        <div className=\"weather-info\">\r\n          <img src={`https://openweathermap.org/img/wn/${weather.weather[0].icon}@2x.png`} alt={weather.weather[0].description} />\r\n          <div>\r\n            <p><strong>Temperatura:</strong> {weather.main.temp}{temperatureUnit === 'metric' ? '°C' : '°F'}</p>\r\n            <p><strong>Warunki:</strong> {weather.weather[0].description}</p>\r\n            <p><strong>Wiatr:</strong> {weather.wind.speed} {temperatureUnit === 'metric' ? 'm/s' : 'mph'} ({weather.wind.deg}°)</p>\r\n            <p><strong>Zachmurzenie:</strong> {weather.clouds.all}%</p>\r\n            <p><strong>Opady:</strong> {weather.rain ? weather.rain[\"3h\"] : 0} mm deszczu</p>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <div id=\"map\" style={{ width: '400px', height: '400px', margin: '20px auto' }}></div>\r\n\r\n      {/* Tabela z prognozą pogody */}\r\n      <h2>Prognoza pogody</h2>\r\n      <table className=\"forecast-table\">\r\n        <thead>\r\n          <tr>\r\n            <th>Data i godzina</th>\r\n            <th>Temperatura</th>\r\n            <th>Warunki</th>\r\n            <th>Wiatr</th>\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n          {forecast.list.map((item) => (\r\n            <tr key={item.dt}>\r\n              <td>{new Date(item.dt * 1000).toLocaleString('pl-PL')}</td>\r\n              <td>{item.main.temp} {temperatureUnit === 'metric' ? '°C' : '°F'}</td>\r\n              <td>\r\n                <img src={`https://openweathermap.org/img/wn/${item.weather[0].icon}.png`} alt={item.weather[0].description} />\r\n                {item.weather[0].description}\r\n              </td>\r\n              <td>{item.wind.speed} {temperatureUnit === 'metric' ? 'm/s' : 'mph'}</td>\r\n            </tr>\r\n          ))}\r\n        </tbody>\r\n      </table>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default WeatherDetailsPage;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}